

The following is a step-by-step guide for setting up your developer environment and getting you started using Python for scripting and automating file system operations on Windows.

Note

This article will cover setting up your environment to use some of the helpful libraries in Python that can automate tasks across platforms, like searching your file system, accessing the internet, parsing file types, etc., from a Windows-centered approach. For Windows-specific operations, check out ctypes, a C-compatible foreign function library for Python, winreg, functions exposing the Windows registry API to Python, and Python/WinRT, enabling access Windows Runtime APIs from Python.
Set up your development environment

When using Python to write scripts that perform file system operations, we recommend you install Python from the Microsoft Store. Installing via the Microsoft Store uses the basic Python3 interpreter, but handles set up of your PATH settings for the current user (avoiding the need for admin access), in addition to providing automatic updates.

If you are using Python for web development on Windows, we recommend a different setup using the Windows Subsystem for Linux. Find a walkthrough in our guide: Get started using Python for web development on Windows. If you're brand new to Python, try our guide: Get started using Python on Windows for beginners. For some advanced scenarios (like needing to access/modify Python's installed files, make copies of binaries, or use Python DLLs directly), you may want to consider downloading a specific Python release directly from python.org or consider installing an alternative, such as Anaconda, Jython, PyPy, WinPython, IronPython, etc. We only recommend this if you are a more advanced Python programmer with a specific reason for choosing an alternative implementation.
Install Python

To install Python using the Microsoft Store:

    Go to your Start menu (lower left Windows icon), type "Microsoft Store", select the link to open the store.

    Once the store is open, select Search from the upper-right menu and enter "Python". Select which version of Python you would like to use from the results under Apps. We recommend using the most recent unless you have a reason not to (such as aligning with the version used on a pre-existing project that you plan to work on). Once you've determined which version you would like to install, select Get.

    Once Python has completed the downloading and installation process, open Windows PowerShell using the Start menu (lower left Windows icon). Once PowerShell is open, enter Python --version to confirm that Python3 has been installed on your machine.

    The Microsoft Store installation of Python includes pip, the standard package manager. Pip allows you to install and manage additional packages that are not part of the Python standard library. To confirm that you also have pip available to install and manage packages, enter pip --version.

Install Visual Studio Code

By using VS Code as your text editor / integrated development environment (IDE), you can take advantage of IntelliSense (a code completion aid), Linting (helps avoid making errors in your code), Debug support (helps you find errors in your code after you run it), Code snippets (templates for small reusable code blocks), and Unit testing (testing your code's interface with different types of input).

Download VS Code for Windows and follow the installation instructions: https://code.visualstudio.com.
Install the Microsoft Python extension

You will need to install the Microsoft Python extension in order to take advantage of the VS Code support features. Learn more.

    Open the VS Code Extensions window by entering Ctrl+Shift+X (or use the menu to navigate to View > Extensions).

    In the top Search Extensions in Marketplace box, enter: Python.

    Find the Python (ms-python.python) by Microsoft extension and select the green Install button.

Open the integrated PowerShell terminal in VS Code

VS Code contains a built-in terminal that enables you to open a Python command line with PowerShell, establishing a seamless workflow between your code editor and command line.

    Open the terminal in VS Code, select View > Terminal, or alternatively use the shortcut Ctrl+` (using the backtick character).

    Note

    The default terminal should be PowerShell, but if you need to change it, use Ctrl+Shift+P to enter the command pallette. Enter Terminal: Select Default Shell and a list of terminal options will display containing PowerShell, Command Prompt, WSL, etc. Select the one you'd like to use and enter Ctrl+Shift+` (using the backtick) to create a new terminal.

    Inside your VS Code terminal, open Python by entering: python

    Try the Python interpreter out by entering: print("Hello World"). Python will return your statement "Hello World".

    Python command line in VS Code

    To exit Python, you can enter exit(), quit(), or select Ctrl-Z.

Install Git (optional)

If you plan to collaborate with others on your Python code, or host your project on an open-source site (like GitHub), VS Code supports version control with Git. The Source Control tab in VS Code tracks all of your changes and has common Git commands (add, commit, push, pull) built right into the UI. You first need to install Git to power the Source Control panel.

    Download and install Git for Windows from the git-scm website.

    An Install Wizard is included that will ask you a series of questions about settings for your Git installation. We recommend using all of the default settings, unless you have a specific reason for changing something.

    If you've never worked with Git before, GitHub Guides can help you get started.

Example script to display the structure of your file system directory

Common system administration tasks can take a huge amount of time, but with a Python script, you can automate these tasks so that they take no time at all. For example, Python can read the contents of your computer's file system and perform operations like printing an outline of your files and directories, moving folders from one directory to another, or renaming hundreds of files. Normally, tasks like these could take up a ton of time if you were to perform them manually. Use a Python script instead!

Let's begin with a simple script that walks a directory tree and displays the directory structure.

    Open PowerShell using the Start menu (lower left Windows icon).

    Create a directory for your project: mkdir python-scripts, then open that directory: cd python-scripts.

    Create a few directories to use with our example script:
    PowerShell 

mkdir food, food\fruits, food\fruits\apples, food\fruits\oranges, food\vegetables

Create a few files within those directories to use with our script:
PowerShell

new-item food\fruits\banana.txt, food\fruits\strawberry.txt, food\fruits\blueberry.txt, food\fruits\apples\honeycrisp.txt, food\fruits\oranges\mandarin.txt, food\vegetables\carrot.txt

Create a new python file in your python-scripts directory:
PowerShell

mkdir src
new-item src\list-directory-contents.py

Open your project in VS Code by entering: code .

Open the VS Code File Explorer window by entering Ctrl+Shift+E (or use the menu to navigate to View > Explorer) and select the list-directory-contents.py file that you just created. The Microsoft Python extension will automatically load a Python interpreter. You can see which interpreter was loaded on the bottom of your VS Code window.

Note

Python is an interpreted language, meaning that it acts as a virtual machine, emulating a physical computer. There are different types of Python interpreters that you can use: Python 2, Python 3, Anaconda, PyPy, etc. In order to run Python code and get Python IntelliSense, you must tell VS Code which interpreter to use. We recommend sticking with the interpreter that VS Code chooses by default (Python 3 in our case) unless you have a specific reason for choosing something different. To change the Python interpreter, select the interpreter currently displayed in blue bar on the bottom of your VS Code window or open the Command Palette (Ctrl+Shift+P) and enter the command Python: Select Interpreter. This will display a list of the Python interpreters that you currently have installed. Learn more about configuring Python environments.

Select Python interpreter in VS Code

Paste the following code into your list-directory-contents.py file and then select save:
Python

import os

root = os.path.join('..', 'food')
for directory, subdir_list, file_list in os.walk(root):
    print('Directory:', directory)
    for name in subdir_list:
        print('Subdirectory:', name)
    for name in file_list:
        print('File:', name)
    print()

Open the VS Code integrated terminal (Ctrl+`, using the backtick character) and enter the src directory where you just saved your Python script:
PowerShell

cd src

Run the script in PowerShell with:
PowerShell

python3 .\list-directory-contents.py

You should see output that looks like this:
PowerShell

    Directory: ..\food
    Subdirectory: fruits
    Subdirectory: vegetables

    Directory: ..\food\fruits
    Subdirectory: apples
    Subdirectory: oranges
    File: banana.txt
    File: blueberry.txt
    File: strawberry.txt

    Directory: ..\food\fruits\apples
    File: honeycrisp.txt

    Directory: ..\food\fruits\oranges
    File: mandarin.txt

    Directory: ..\food\vegetables
    File: carrot.txt

    Use Python to print that file system directory output to it's own text file by entering this command directly in your PowerShell terminal: python3 list-directory-contents.py > food-directory.txt

Congratulations! You've just written an automated systems administration script that reads the directory and files you created and uses Python to display, and then print, the directory structure to it's own text file.

Note

If you're unable to install Python 3 from the Microsoft Store, see this issue for an example of how to handle the pathing for this sample script.
Example script to modify all files in a directory

This example uses the files and directories you just created, renaming each of the files by adding the file's last modified date to the beginning of the filename.

    Inside the src folder in your python-scripts directory, create a new Python file for your script:
    PowerShell 

new-item update-filenames.py

Open the update-filenames.py file, paste the following code into the file, and save it:

Note

os.getmtime returns a timestamp in ticks, which is not easily readable. It must be converted to a standard datetime string first.
Python

import datetime
import os

root = os.path.join('..', 'food')
for directory, subdir_list, file_list in os.walk(root):
    for name in file_list:
        source_name = os.path.join(directory, name)
        timestamp = os.path.getmtime(source_name)
        modified_date = str(datetime.datetime.fromtimestamp(timestamp)).replace(':', '.')
        target_name = os.path.join(directory, f'{modified_date}_{name}')

        print(f'Renaming: {source_name} to: {target_name}')

        os.rename(source_name, target_name)

Test your update-filenames.py script by running it: python3 update-filenames.py and then running your list-directory-contents.py script again: python3 list-directory-contents.py

You should see output that looks like this:
PowerShell

    Renaming: ..\food\fruits\banana.txt to: ..\food\fruits\2019-07-18 12.24.46.385185_banana.txt
    Renaming: ..\food\fruits\blueberry.txt to: ..\food\fruits\2019-07-18 12.24.46.391170_blueberry.txt
    Renaming: ..\food\fruits\strawberry.txt to: ..\food\fruits\2019-07-18 12.24.46.389174_strawberry.txt
    Renaming: ..\food\fruits\apples\honeycrisp.txt to: ..\food\fruits\apples\2019-07-18 12.24.46.395160_honeycrisp.txt
    Renaming: ..\food\fruits\oranges\mandarin.txt to: ..\food\fruits\oranges\2019-07-18 12.24.46.398151_mandarin.txt
    Renaming: ..\food\vegetables\carrot.txt to: ..\food\vegetables\2019-07-18 12.24.46.402496_carrot.txt

    PS C:\src\python-scripting\src> python3 .\list-directory-contents.py
    ..\food\
    Directory: ..\food
    Subdirectory: fruits
    Subdirectory: vegetables

    Directory: ..\food\fruits
    Subdirectory: apples
    Subdirectory: oranges
    File: 2019-07-18 12.24.46.385185_banana.txt
    File: 2019-07-18 12.24.46.389174_strawberry.txt
    File: 2019-07-18 12.24.46.391170_blueberry.txt

    Directory: ..\food\fruits\apples
    File: 2019-07-18 12.24.46.395160_honeycrisp.txt

    Directory: ..\food\fruits\oranges
    File: 2019-07-18 12.24.46.398151_mandarin.txt

    Directory: ..\food\vegetables
    File: 2019-07-18 12.24.46.402496_carrot.txt

    Use Python to print the new file system directory names with the last-modified timestamp prepended to it's own text file by entering this command directly in your PowerShell terminal: python3 list-directory-contents.py > food-directory-last-modified.txt

Hope you learned a few fun things about using Python scripts for automating basic systems administration tasks. There is, of course, a ton more to know, but we hope this got you started on the right foot. We've shared a few additional resources to continue learning below.
Additional resources

    Python Docs: File and Directory Access: Python documentation about working with file systems and using modules for reading the properties of files, manipulating paths in a portable way, and creating temporary files.
    Learn Python: String_Formatting tutorial: More about using the "%" operator for string formatting.
    10 Python File System Methods You Should Know: Medium article about manipulating files and folders With os and shutil.
    The Hitchhikers Guide to Python: Systems Administration: An "opinionated guide" that offers overviews and best practices on topics related to Python. This section covers System Admin tools and frameworks. This guide is hosted on GitHub so you can file issues and make contributions.

Recommended content

    Python on Windows for beginners

    A guide to help you get started if your brand new to using Python on Windows.
    FAQ's about using Python on Windows

    Get help by reviewing answers to frequently asked questions (FAQs) about using Python on Windows for development.
    Web development with Python on Windows

    A step-by-step guide to get started using Python for web development on Windows, including set up for frameworks like Flask and Django.
    PowerShell Remoting Over SSH - PowerShell

    Explains how to set up the SSH protocol for PowerShell remoting.

Feedback

Submit and view feedback for
View all page feedback
In this article

    Set up your development environment
    Install Python
    Install Visual Studio Code
    Install the Microsoft Python extension

    Previous Version Docs
    Blog
    Contribute
    Privacy & Cookies
    Terms of Use
    Trademarks
    © Microsoft 2022

